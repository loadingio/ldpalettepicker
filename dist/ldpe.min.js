!function(){var r;function f(e,t){var n,r={}.hasOwnProperty;for(n in t)r.call(t,n)&&(e[n]=t[n]);return e}(r=function(e){var o,s,c,d,i,u,h,p,t,a,n;return this.opt=e=f({},e=null==e?{}:e),this.root=o="string"==typeof e.root?document.querySelector(e.root):e.root,this.el=s={},s.ed={picker:ld$.find(o,".ldcolorpicker",0),pal:ld$.find(o,".ldp",0),colors:ld$.find(o,".ldp .colors",0),hex:ld$.find(o,"input[data-tag=hex]",0),sel:ld$.find(o,"select",0),cfgs:ld$.find(o,".config"),tag:ld$.find(o,"input[data-tag=tag]",0)},c={stack:[],cur:null,handle:null,undo:function(){var e=c.stack.pop();if(e)return s.ed.pal.innerHTML=e,s.ed.colors=ld$.find(s.ed.pal,".colors",0)},push:function(e){var t,n=this;return null==e&&(e=!1),(t=this.handle)&&clearTimeout(t),this.cur||(this.cur=s.ed.pal.innerHTML),t=function(){var e;return(e=n.stack)[e.length-1]!==n.cur&&n.stack.push(n.cur),n.handle=null,n.cur=null,n},e?t():this.handle=setTimeout(t,200)},clear:function(){return this.stack.splice(0),this.handle&&clearTimeout(this.handle),this.handle=null,this.cur=null,this}},this.undo=function(){return c.undo()},this.clearLog=function(){return c.clear()},this.ldcp=d=new ldcolorpicker(s.ed.picker,{inline:!0}),d.on("change",function(e){return c.push(),a(e)}),this.ldrs=i={},f(u={base:{min:0,max:255,step:1,hide_min_max:!0,hide_from_to:!0,grid:!1}},{"hsl-h":((t=f({},u.base)).max=360,t),"hsl-s":((t=f({},u.base)).max=1,t.step=.01,t),"hsl-l":((t=f({},u.base)).max=1,t.step=.01,t),"hcl-h":((t=f({},u.base)).max=360,t),"hcl-c":((t=f({},u.base)).max=230,t),"hcl-l":((t=f({},u.base)).max=100,t)}),u["rgb-r"]=u["rgb-g"]=u["rgb-b"]=u.base,["rgb-r","rgb-g","rgb-b","hsl-h","hsl-s","hsl-l","hcl-h","hcl-c","hcl-l"].map(function(e){return r=(t=e).split("-"),l=function(e){var t=d.getColor(r[0]);return t[r[1]]=e.target.value,d.setColor(t)},a=debounce(500,l),(e=ld$.find(o,".value[data-tag="+t+"]",0)).addEventListener("change",l),e.addEventListener("input",a),i[t]=new ldslider(f({root:ld$.find(o,".ldrs[data-tag="+t+"]",0)},u[t])),i[n=t].on("change",function(e){var t;return d._slider=n,(t=d.getColor(r[0]))[r[1]]=e,d.setColor(t)});var t,n,r,l,a}),s.ed.hex.addEventListener("change",function(e){return d.setColor(e.target.value)}),s.ed.hex.addEventListener("input",debounce(500,function(e){return d.setColor(e.target.value)})),s.ed.sel.addEventListener("change",function(t){var e,n,r,l=[];for(e in s.ed.cfgs.map(function(e){return e.classList[ld$.attr(e,"data-tag")===t.target.value?"add":"remove"]("active")}),n=i)r=n[e],l.push(r.update());return l}),s.ed.tag.addEventListener("input",function(e){return ld$.find(o,".color.active",0).setAttribute("data-tag",s.ed.tag.value)||""}),h=function(e){var t,n=p.data.box;return p.data.colors.length*((e=0<(t=e.clientX-n.x)?t:0)<(t=n.width)?e:t)/n.width},p=function(e){var t,n=p.data,r=(n.box,n.srcidx),l=n.initx,a=n.colors,o=n.span,d=Math.round(h(e)),i=s.ed.colors.childNodes[r],o=(n=(t=e.clientX-l)>(l=-r*o)?t:l)<(o=(a.length-r-1)*o)?n:o;if(i.style.transform="translate("+o+"px,0)",r!==d&&r+1!==d)return i.style.transform="translate(0,0)",p.data.initx=e.clientX,c.push(),i=s.ed.colors.childNodes[r],e=s.ed.colors.childNodes[d],i.remove(),s.ed.colors.insertBefore(i,e),p.data.srcidx=d<r?d:d-1},s.ed.pal.addEventListener("mousedown",function(e){if(ld$.parent(e.target,".colors",s.ed.pal))return p.data={initx:e.clientX,colors:ld$.find(s.ed.colors,".color"),box:s.ed.colors.getBoundingClientRect()},p.data.srcidx=Math.floor(h(e)),p.data.span=p.data.box.width/p.data.colors.length,document.removeEventListener("mousemove",p),document.addEventListener("mousemove",p)}),s.ed.pal.addEventListener("mouseup",function(e){if(ld$.parent(e.target,".colors",s.ed.pal))return ld$.find(s.ed.colors,".color").map(function(e){return e.style.transform=""}),document.removeEventListener("mousemove",p)}),document.addEventListener("mouseup",function(){return document.removeEventListener("mousemove",p)}),this.init=t=function(r){var e,t=(e=[(r=f({pal:{}},r=null==r?{}:r)).pal.hexs||r.pal.colors.map(function(e){return ldcolor.hex(e)}),r.pal.key,r.pal.name||"Custom"])[0],n=e[2],l=s.ed.colors.parentNode;return(e=e[1])?l.setAttribute("data-key",e):l.removeAttribute("data-key"),s.ed.colors.innerHTML=t.map(function(e,t){var n=ldcolor.hcl(e),e=ldcolor.web(e);return'<div class="color'+(t?"":" active")+(n.l<50?" dark":"")+'"\ndata-tag="'+((r.pal.hexs||r.pal.colors)[t].tag||"")+'"\nstyle="background:'+e+";color:"+e+'">\n  <div data-action>\n    <i class="i-clone"></i>\n    <i class="i-bars"></i>\n    <i class="i-close"></i>\n  </div>\n</div>'}).join(""),ld$.find(l,".name",0).innerHTML=n||"untitled",a(t[0]),d.setColor(t[0]),s.ed.tag.value=(r.pal.hexs||r.pal.colors)[0].tag||""},a=function(n){var e=ldcolor.hcl(n),t=ld$.find(o,".color.active",0);return t.style.background=ldcolor.rgbaStr(n),t.classList[e.l<50?"add":"remove"]("dark"),s.ed.hex.value=ldcolor.hex(n),n={rgb:ldcolor.rgb(n),hsl:ldcolor.hsl(n),hcl:e},["rgb-r","rgb-g","rgb-b","hsl-h","hsl-s","hsl-l","hcl-h","hcl-c","hcl-l"].map(function(e){var t=e.split("-"),t=n[t[0]][t[1]];return"hsl-s"!==e&&"hsl-l"!==e&&(t=Math.round(t)),ld$.find(o,".value[data-tag="+e+"]",0).value=t,d._slider===e?d._slider=null:i[e].set(t)})},n={editColor:function(e){var t,n=ld$.parent(e,"i",s.ed.pal),r=ld$.parent(e,".color",s.ed.pal);if(n&&!n.classList.contains("i-bars")&&r.classList.contains("active")){if(n.classList.contains("i-close"))return r.parentNode.childNodes.length<=1||(c.push(),r.classList.contains("active")&&(t=r.parentNode.childNodes[ld$.index(r)+1]||r.parentNode.childNodes[ld$.index(r)-1])&&t.classList.add("active"),r.remove()),!0;if(n.classList.contains("i-clone"))return n=r.cloneNode(!0),ld$.child(r.parentNode).map(function(e){return e.classList.remove("active")}),n.classList.add("active"),ld$.insertAfter(r.parentNode,n,r),!0}if(r)return ld$.child(r.parentNode).map(function(e){return e.classList[e===r?"add":"remove"]("active")}),d.setColor(r.style.backgroundColor),s.ed.tag.value=r.getAttribute("data-tag")||"",!0}},o.addEventListener("click",function(e){e=e.target;n.editColor(e)}),this.getPal=function(){var e=s.ed.colors.parentNode,t=ld$.attr(e,"data-key"),e=ld$.find(e,".name",0).textContent||"untitled";return{colors:ld$.find(s.ed.colors,".color").map(function(e){return{value:ldcolor.rgbaStr(e.style.backgroundColor)}}),name:e,key:t}},t({pal:e.palette||JSON.parse(JSON.stringify(r.defaultPalette))}),this}).prototype=f(Object.create(Object.prototype),{syncUi:function(){var e,t,n,r=[];for(e in t=this.ldrs)n=t[e],r.push(n.update());return r}}),r.defaultPalette={name:"sample",colors:["#E8614C","#F4A358","#E8DA8D","#2DA88B","#294B59"]},"undefined"!=typeof module&&null!==module?module.exports=r:"undefined"!=typeof window&&null!==window&&(window.ldpe=r)}.call(this);
